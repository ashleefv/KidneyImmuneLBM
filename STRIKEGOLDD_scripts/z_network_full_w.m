
syms w1 w2 w3 w4 w5 w6 w7 w8 w9 w10 w11 w12 w13 w14 w15 w16 w17 w18 w19 w20 w21 w22 w23 w24 w25 w26 w27 w28 w29 w30 w31 w32 w33 w34 w35 w36 w37 w38 w39 w40 ...
    y1 y2 y3 y4 y5 y6 y7 y8 y9 y10 y11 y12 y13  y14 y15 y16 y17 y18 y19 y20 y21 y22 y23 y24 y25 y26 y27 y28 y29 y30 ...
    
% states:
x    = [y1; y2; y3; y4; y5; y6; y7; y8; y9; y10; y11; y12; y13; y14; y15; y16; y17; y18; y19; y20; y21; y22; y23; y24; y25; y26; y27; y28; y29; y30];

% outputs:
h    = x;  

% no input:
u    = [];

% parameters:
p    = [w1; w2; w3; w4; w5; w6; w7; w8; w9; w10; w11; w12; w13; w14; w15; w16; w17; w18; w19; w20; w21; w22; w23; w24; w25; w26; w27; w28; w29; w30; w31; w32; w33; w34; w35; w36; w37; w38; w39; w40];
         
% known parameters
ymax = 1;
k = 0.5;
t = 1;
n3=1.4; n4=1.4; n5=1.4; n6=1.4; n7=1.4; n8=1.4; n9=1.4; n10=1.4; n11=1.4; n12=1.4; n13=1.4; n14=1.4; n15=1.4; n16=1.4; n17=1.4; n18=1.4; n19=1.4; n20=1.4; n21=1.4; n22=1.4; n23=1.4; n24=1.4; n25=1.4; n26=1.4; n27=1.4; n28=1.4; n29=1.4; n30=1.4; n31=1.4; 
n32=1.4; n33=1.4; n34=1.4; n35=1.4; n36=1.4; n37=1.4; n38=1.4; n39=1.4; n40=1.4;

% dynamic equations:    
f    = [(w1*ymax - y1)/t;
        (w2*ymax - y2)/t;
        ((w4*(k^n4+1)*y1^n4*ymax)/(k^n4 + y1^n4) - y3)/t;
((w19*(k^n19+1)*y27^n19*ymax)/(k^n19 + y27^n19)- y4)/t; 
((w20*(k^n20+1)*y27^n20*ymax)/(k^n20 + y27^n20) - y5)/t;
((w16*(k^n16+1)*y19^n16*ymax)/(k^n16 + y19^n16) - y6)/t; 
((w21*(k^n21+1)*y3^n21*ymax)/(k^n21 + y3^n21) - y7)/t; 
((w5*(k^n5+1)*y3^n5*ymax)/(k^n5 + y3^n5) - y8)/t; 
((w3*(k^n3+1)*y2^n3*ymax)/(k^n3 + y2^n3) - y9)/t; 
((w6*(k^n6+1)*y8^n6*ymax)/(k^n6 + y8^n6) - y10)/t; 
((w22*(k^n22+1)*y7^n22*ymax)/(k^n22 + y7^n22) - y11)/t; 
(w25*(k^n25+1)*y11^n25/(k^n25 + y11^n25) + w34*(k^n34+1)*y22^n34/(k^n34 + y22^n34) - (w25*(k^n25+1)*y11^n25/(k^n25 + y11^n25))*(w34*(k^n34+1)*y22^n34/(k^n34 + y22^n34))*ymax - y12)/t; %OR 
(w9*(k^n9+1)*y10^n9/(k^n9 + y10^n9) + w11*(k^n11)+1*y14^n11/(k^n11 + y14^n11) - ((w9*(k^n9+1)*y10^n9/(k^n9 + y10^n9))*(w11*(k^n11+1)*y14^n11/(k^n11 + y14^n11)))*ymax - y13)/t; 
((w8*(k^n8+1)*y9^n8/(k^n8 + y9^n8))*ymax - y14)/t; 
((w10*(k^n10+1)*y14^n10/(k^n10 + y14^n10))*ymax - y15)/t; 
(w23*(k^n23+1)*y5^n23/(k^n23 + y5^n23) + w24*(k^n24+1)*y4^n24/(k^n24 + y4^n24) - ((w23*(k^n23+1)*y5^n23/(k^n23 + y5^n23))*( w24*(k^n24+1)*y4^n24/(k^n24 + y4^n24)))*ymax - y16)/t; 
((w26*(k^n26+1)*y16^n26/(k^n26 + y16^n26))*ymax - y17)/t; 
(w30*(k^n30+1)*y12^n30/(k^n30 + y12^n30) +  w29*(k^n29+1)*y26^n29/(k^n29 + y26^n29) - ((w30*(k^n30+1)*y12^n30/(k^n30 + y12^n30))*(w29*(k^n29+1)*y26^n29/(k^n29 + y26^n29)))*ymax - y18)/t; 
((w7*(k^n7+1)*y9^n7/(k^n7 + y9^n7)*w7*(k^n7+1)*y13^n7/(k^n7 + y13^n7)) + w13*(k^n13+1)*y15^n13/(k^n13 + y15^n13) - ((w7*(k^n7+1)*y9^n7/(k^n7 + y9^n7)*w7*(k^n7+1)*y13^n7/(k^n7 + y13^n7)))*(w13*(k^n13+1)*y15^n13/(k^n13 + y15^n13))*ymax - y19)/t; 
(w33*(k^n33+1)*y22^n33/(k^n33 + y22^n33) + w40*(k^n40+1)*y29^n40/(k^n40 + y29^n40) - ((w40*(k^n40+1)*y29^n40/(k^n40 + y29^n40))*(w33*(k^n33+1)*y29^n33/(k^n33 + y29^n33)))*ymax - y20)/t;
(w35*(k^n35+1)*y12^n35/(k^n35 + y12^n35)*(w35*(k^n35+1)*y20^n35/(k^n35 + y20^n35))*ymax - y21)/t; 
(w27*(k^n27+1)*y17^n27/(k^n27 + y17^n27)*ymax - y22)/t; 
((w14*(k^n14+1)*y19^n14/(k^n14 + y19^n14)) + (w31*(k^n31+1)*y18^n31/(k^n31 + y18^n31)) - ((w31*(k^n31+1)*y18^n31/(k^n31 + y18^n31))*(w14*(k^n14+1)*y19^n14/(k^n14 + y19^n14)))*ymax - y23)/t; 
((w12*(k^n12+1)*y18^n12/(k^n12 + y18^n12)) + (w15*(k^n15+1)*y19^n15/(k^n15 + y19^n15)) - ((w15*(k^n15+1)*y19^n15/(k^n15 + y19^n15))*(w12*(k^n12+1)*y18^n12/(k^n12 + y18^n12)))*ymax - y24)/t; 
((w18*(k^n18+1)*y19^n18/(k^n18 + y19^n18)) + (w32*(k^n32+1)*y18^n32/(k^n32 + y18^n32)) - ((w18*(k^n18+1)*y19^n18/(k^n18 + y19^n18))*(w32*(k^n32+1)*y18^n32/(k^n32 + y18^n32)))*ymax - y25)/t; 
(w28*(k^n28+1)*y4^n28/(k^n28 + y4^n28)*ymax - y26)/t; 
(w17*(k^n17+1)*y6^n17/(k^n17 + y6^n17)*ymax - y27)/t;
(w38*(k^n38+1)*y29^n38/(k^n38 + y29^n38)*ymax - y28)/t; 
((1-w36*(k^n36+1)*y20^n36/(k^n36 + y20^n36)) + (w37*(k^n37+1)*y26^n37/(k^n37 + y26^n37)) - (w37*(k^n37+1)*y26^n37/(k^n37 + y26^n37))*((1-w36*(k^n36+1)*y20^n36/(k^n36 + y20^n36)))*ymax - y29)/t; 
(w39*(k^n39+1)*y28^n39/(k^n39 + y28^n39)*ymax - y30)/t;
]; 
    
% initial conditions:    
ics  = [0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

% which initial conditions are known:
known_ics = [1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1];

save('networkODE_w.mat','x','h','u','p','f','ics','known_ics');
