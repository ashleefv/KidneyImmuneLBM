
syms  k3 k4 k5 k6 k7 k8 k9 k10 k11 k12 k13 k14 k15 k16 k17 k18 k19 k20 k21 k22 k23 k24 k25 k26 k27 k28 k29 k30 k31 k32 k33 k34 k35 k36 k37 k38 k39 k40...
      y1 y2 y3 y4 y5 y6 y7 y8 y9 y10 y11 y12 y13  y14 y15 y16 y17 y18 y19 y20 y21 y22 y23 y24 y25 y26 y27 y28 y29 y30 ...
    
% states:
x    = [y1; y2; y3; y4; y5; y6; y7; y8; y9; y10; y11; y12; y13; y14; y15; y16; y17; y18; y19; y20; y21; y22; y23; y24; y25; y26; y27; y28; y29; y30];

% outputs:
h    = x;  

% no input:
u    = [];

% parameters:
p    = [k3; k4; k5; k6; k7; k8; k9; k10; k11; k12; k13; k14; k15; k16; k17; k18; k19; k20; k21; k22; k23; k24; k25; k26; k27; k28; k29; k30; k31; k32; k33; k34; k35; k36; k37; k38; k39; k40];
         
% known parameters
ymax = 1;
w = 1;
t = 1;

n3=1.4; n4=1.4; n5=1.4; n6=1.4; n7=1.4; n8=1.4; n9=1.4; n10=1.4; n11=1.4; n12=1.4; n13=1.4; n14=1.4; n15=1.4; n16=1.4; n17=1.4; n18=1.4; n19=1.4; n20=1.4; n21=1.4; n22=1.4; n23=1.4; n24=1.4; n25=1.4; n26=1.4; n27=1.4; n28=1.4; n29=1.4; n30=1.4; n31=1.4; 
n32=1.4; n33=1.4; n34=1.4; n35=1.4; n36=1.4; n37=1.4; n38=1.4; n39=1.4; n40=1.4;

% dynamic equations:    
f    = [(w*ymax - y1)/t;
        (w*ymax - y2)/t;
        ((w*(k4^n4+1)*y1^n4*ymax)/(k4^n4 + y1^n4) - y3)/t;
((w*(k19^n19+1)*y27^n19*ymax)/(k19^n19 + y27^n19)- y4)/t; 
((w*(k20^n20+1)*y27^n20*ymax)/(k20^n20 + y27^n20) - y5)/t;
((w*(k16^n16+1)*y19^n16*ymax)/(k16^n16 + y19^n16) - y6)/t; 
((w*(k21^n21+1)*y3^n21*ymax)/(k21^n21 + y3^n21) - y7)/t; 
((w*(k5^n5+1)*y3^n5*ymax)/(k5^n5 + y3^n5) - y8)/t; 
((w*(k3^n3+1)*y2^n3*ymax)/(k3^n3 + y2^n3) - y9)/t; 
((w*(k6^n6+1)*y8^n6*ymax)/(k6^n6 + y8^n6) - y10)/t; 
((w*(k22^n22+1)*y7^n22*ymax)/(k22^n22 + y7^n22) - y11)/t; 
(w*(k25^n25+1)*y11^n25/(k25^n25 + y11^n25) + w*(k34^n34+1)*y22^n34/(k^n34 + y22^n34) - (w*(k25^n25+1)*y11^n25/(k25^n25 + y11^n25))*(w*(k34^n34+1)*y22^n34/(k34^n34 + y22^n34))*ymax - y12)/t; %OR 
(w*(k9^n9+1)*y10^n9/(k9^n9 + y10^n9) + w*(k11^n11)+1*y14^n11/(k11^n11 + y14^n11) - ((w*(k9^n9+1)*y10^n9/(k9^n9 + y10^n9))*(w*(k11^n11+1)*y14^n11/(k11^n11 + y14^n11)))*ymax - y13)/t; 
((w*(k8^n8+1)*y9^n8/(k8^n8 + y9^n8))*ymax - y14)/t; 
((w*(k10^n10+1)*y14^n10/(k10^n10 + y14^n10))*ymax - y15)/t; 
(w*(k23^n23+1)*y5^n23/(k23^n23 + y5^n23) + w*(k24^n24+1)*y4^n24/(k24^n24 + y4^n24) - ((w*(k23^n23+1)*y5^n23/(k23^n23 + y5^n23))*( w*(k24^n24+1)*y4^n24/(k24^n24 + y4^n24)))*ymax - y16)/t; 
((w*(k26^n26+1)*y16^n26/(k26^n26 + y16^n26))*ymax - y17)/t; 
(w*(k30^n30+1)*y12^n30/(k30^n30 + y12^n30) +  w*(k29^n29+1)*y26^n29/(k29^n29 + y26^n29) - ((w*(k30^n30+1)*y12^n30/(k30^n30 + y12^n30))*(w*(k29^n29+1)*y26^n29/(k29^n29 + y26^n29)))*ymax - y18)/t; 
((w*(k7^n7+1)*y9^n7/(k7^n7 + y9^n7)*w*(k7^n7+1)*y13^n7/(k7^n7 + y13^n7)) + w*(k13^n13+1)*y15^n13/(k13^n13 + y15^n13) - ((w*(k7^n7+1)*y9^n7/(k7^n7 + y9^n7)*w*(k7^n7+1)*y13^n7/(k7^n7 + y13^n7)))*(w*(k13^n13+1)*y15^n13/(k13^n13 + y15^n13))*ymax - y19)/t; 
(w*(k33^n33+1)*y22^n33/(k33^n33 + y22^n33) + w*(k40^n40+1)*y29^n40/(k40^n40 + y29^n40) - ((w*(k40^n40+1)*y29^n40/(k40^n40 + y29^n40))*(w*(k33^n33+1)*y29^n33/(k33^n33 + y29^n33)))*ymax - y20)/t;
(w*(k35^n35+1)*y12^n35/(k35^n35 + y12^n35)*(w*(k35^n35+1)*y20^n35/(k35^n35 + y20^n35))*ymax - y21)/t; 
(w*(k27^n27+1)*y17^n27/(k27^n27 + y17^n27)*ymax - y22)/t; 
((w*(k14^n14+1)*y19^n14/(k14^n14 + y19^n14)) + (w*(k31^n31+1)*y18^n31/(k31^n31 + y18^n31)) - ((w*(k31^n31+1)*y18^n31/(k31^n31 + y18^n31))*(w*(k14^n14+1)*y19^n14/(k14^n14 + y19^n14)))*ymax - y23)/t; 
((w*(k12^n12+1)*y18^n12/(k12^n12 + y18^n12)) + (w*(k15^n15+1)*y19^n15/(k15^n15 + y19^n15)) - ((w*(k15^n15+1)*y19^n15/(k15^n15 + y19^n15))*(w*(k12^n12+1)*y18^n12/(k12^n12 + y18^n12)))*ymax - y24)/t; 
((w*(k18^n18+1)*y19^n18/(k18^n18 + y19^n18)) + (w*(k15^n32+1)*y18^n32/(k15^n32 + y18^n32)) - ((w*(k18^n18+1)*y19^n18/(k18^n18 + y19^n18))*(w*(k32^n32+1)*y18^n32/(k32^n32 + y18^n32)))*ymax - y25)/t; 
(w*(k28^n28+1)*y4^n28/(k28^n28 + y4^n28)*ymax - y26)/t; 
(w*(k17^n17+1)*y6^n17/(k17^n17 + y6^n17)*ymax - y27)/t;
(w*(k38^n38+1)*y29^n38/(k38^n38 + y29^n38)*ymax - y28)/t; 
((1-w*(k36^n36+1)*y20^n36/(k36^n36 + y20^n36)) + (w*(k37^n37+1)*y26^n37/(k37^n37 + y26^n37)) - (w*(k37^n37+1)*y26^n37/(k37^n37 + y26^n37))*((1-w*(k36^n36+1)*y20^n36/(k36^n36 + y20^n36)))*ymax - y29)/t; 
(w*(k39^n39+1)*y28^n39/(k39^n39 + y28^n39)*ymax - y30)/t;
]; 
    
% initial conditions:    
ics  = [0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

% which initial conditions are known:
known_ics = [1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1];

save('networkODE_k.mat','x','h','u','p','f','ics','known_ics');
